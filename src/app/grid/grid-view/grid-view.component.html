<div
    #containerEl
    style="
        display: grid;
        height: 100%;
        grid-template-rows: max-content 1fr;
        grid-template-columns: max-content 1fr;
        overflow: hidden;
    "
    class="container"
>
    <!-- Top-left corner -->
    <div
        style="
            z-index: 2;
            border-right: 3px solid rgb(194, 24, 91);
            border-bottom: 3px solid rgb(194, 24, 91);
        "
    ></div>

    <!-- Column titles -->
    <div
        [style.overflow]="'visible'"
        [style.z-index]="1"
        style="
            max-height: 150px;
            overflow-wrap: anywhere;
            border-bottom: 3px solid rgb(194, 24, 91);
        "
    >
        <!-- This div is transform'd -->
        <div style="overflow-y: hidden; max-height: 100%">
            <div *ngIf="gridView$ | async as gridView" [style.display]="'flex'">
                <div
                    *ngFor="let col of gridView.cols"
                    [style.width.px]="col.dim * scale"
                    [style.justify-content]="'center'"
                    [style.font-size.rem]="1.5"
                    style="padding: 10px 0px"
                    class="flex-row"
                >
                    {{ col.title }}
                </div>
            </div>
        </div>
    </div>

    <!-- Row Titles -->
    <div
        [style.overflow]="'visible'"
        [style.z-index]="1"
        class="flex-col"
        style="
            max-width: 150px;
            overflow-wrap: anywhere;
            border-right: 3px solid rgb(194, 24, 91);
        "
    >
        <!-- This div is transform'd -->
        <div style="overflow-x: hidden; max-width: 100%">
            <ng-container *ngIf="gridView$ | async as gridView">
                <div
                    *ngFor="let row of gridView.rows"
                    [style.height.px]="row.dim * scale"
                    [style.justify-content]="'center'"
                    [style.font-size.rem]="1.5"
                    style="padding: 0px 10px"
                    class="flex-col"
                >
                    {{ row.title }}
                </div>
            </ng-container>
        </div>
    </div>

    <!-- Images -->
    <svg
        style="min-height: 0; min-width: 0"
        [style.overflow]="'visible'"
        #imageGrid
    >
        <g>
            <g *ngIf="gridView$ | async as gridView">
                <g *ngFor="let row of gridView.rows; index as r">
                    <g *ngFor="let col of gridView.cols; index as c">
                        <image
                            *ngLet="gridView.cellAt(r, c) as cell"
                            [attr.height]="cell.height"
                            [attr.width]="cell.width"
                            [attr.x]="cell.x"
                            [attr.y]="cell.y"
                            [attr.href]="cell.image.data"
                            [contextMenu]="contextMenu"
                            contextMenuValue="value"
                        />
                    </g>
                </g>
            </g>
        </g>
    </svg>
</div>

<context-menu #contextMenu menuClass="context-menu">
    <ng-template contextMenuItem [passive]="true">
        <span class="menu-item-title">Context menu title</span>
    </ng-template>

    <ng-template contextMenuItem let-value
        >This is the context menu value "{{ value }}"</ng-template
    >
    <ng-template contextMenuItem let-value> Cut {{ value }} </ng-template>
    <ng-template contextMenuItem let-value [divider]="true"></ng-template>
    <ng-template contextMenuItem [disabled]="true">
        Disabled menu item
    </ng-template>
</context-menu>

<style>
    .container > div {
        background-color: #303030;
    }
</style>
